// jCart v1.3
// http://conceptlogic.com/jcart/
$(function(){var e=function(){function e(){var e=$("#jcart-subtotal strong").text(),t=$("#jcart-title").parent().text(),n=0,r=0;t=$.trim(t);n=t.indexOf("(")+1;r=t.length-1;t=t.substring(n);t=t.substring(0,r);$("#external-subtotal").text(e);$("#external-item-count").text(t)}function a(t){var r=t.find("[name="+s.item.qty+"]"),o=t.find("[name="+s.item.add+"]");$.ajax({data:t.serialize()+"&"+s.item.add+"="+o.val(),success:function(t){r.val()>0&&i.css("display")==="none"&&i.fadeIn("100").delay("400").fadeOut("100");n.html(t);$("#jcart-buttons").remove();e()}})}function f(e){var t=e.parent().find('[name="jcartItemId[]"]').val(),n=e.val();if(n)var i=window.setTimeout(function(){$.ajax({data:{jcartUpdate:1,itemId:t,itemQty:n,jcartIsCheckout:u,jcartToken:r}})},1e3);e.keydown(function(e){e.which!==9&&window.clearTimeout(i)})}function l(e){var t=e.attr("href");t=t.split("=");var n=t[1];$.ajax({type:"GET",data:{jcartRemove:n,jcartIsCheckout:u}})}e();var t="jcart",n=$("#jcart"),r=$("[name=jcartToken]").val(),i=$("#jcart-tooltip"),s=function(){var e=null;$.ajax({url:t+"/config-loader.php",data:{ajax:"true"},dataType:"json",async:!1,success:function(t){e=t},error:function(){alert("Ajax error: Edit the path in jcart.js to fix.")}});return e}(),o=function(){if(s.tooltip===!0){i.text(s.text.itemAdded);$(".jcart [type=submit]").mouseenter(function(e){var t=e.pageY+25,n=e.pageX+ -10;$("body").append(i);i.css({top:n+"px",left:t+"px"})}).mousemove(function(e){var t=e.pageY+25,n=e.pageX+ -10;i.css({top:t+"px",left:n+"px"})}).mouseleave(function(){i.hide()})}$("#jcart-buttons").remove();$.ajaxSetup({type:"POST",url:t+"/relay.php",success:function(t){n.html(t);$("#jcart-buttons").remove();e()},error:function(e,t){var n=e.status,r="Ajax error: ";n===0&&(r+="Check your network connection.");if(n===404||n===500)r+=n;if(t==="parsererror"||t==="timeout")r+=t;alert(r)}})}(),u=$("#jcart-is-checkout").val();$(".jcart").submit(function(e){a($(this));e.preventDefault()});n.keydown(function(e){e.which===13&&e.preventDefault()});n.delegate('[name="jcartItemQty[]"]',"keyup",function(){f($(this))});n.delegate(".jcart-remove","click",function(e){l($(this));e.preventDefault()})}()});